(function(){function d(a,b){if(this.addEventListener)return this.addEventListener(a,b);if(this.attachEvent)return this.attachEvent("on"+a,b);throw"Unable to attach event.";}function i(c){var b=document.createElement("span");"\n"===c?(b.innerHTML="<br /><span style='display:inline-block;'></span>",b.isNewLine=!0):" "===c?b.innerHTML="<span style='display:inline-block'>&nbsp;</span>":"\t"===c?b.innerHTML="<span style='display:inline-block;'>&nbsp;&nbsp;&nbsp;&nbsp;</span>":void 0!==b.textContent?b.textContent=
c:b.innerText=c;b.goofyTextChr=!0;d.call(b,"click",function(){a.target(b)});return b}function j(a,b){if(!b)return a;for(;b.childNodes.length;)a.appendChild(b.childNodes[0]);return a}function k(a){if(!a.goofyTextInitialized){a.goofyTextInitialized=!0;var b;a:{b=document.createElement("div");for(var l=document.createElement("div"),e=null;a.childNodes.length;){var f=a.childNodes[0];if(!f){b=!1;break a}if(3===f.nodeType){for(var g=0;g<f.length;++g){if(f.textContent)e=i(f.textContent[g]);else if(f.nodeValue)e=
i(f.nodeValue.charAt(g));else throw"What am I supposed to do?";b.appendChild(e)}l.appendChild(f)}else b.appendChild(f)}}a.innerHTML="";j(a,b);d.call(a,"click",function(){console.log("STUB: Search for the last place a cursor could go before this point.")});return a}}var a={targetCharNode:null,hijacker:document.createElement("textarea"),processHijacker:function(){buffer=a.hijacker.value;a.hijacker.value="";a.putText(buffer)},nextColor:"black",colorA:"black",colorB:"transparent",cycleTimeout:null,preventUntarget:!1,
cycle:function(c){if(a.targetCharNode){a.nextColor=c||a.nextColor===a.colorB?a.colorA:a.colorB;a.targetCharNode.forceRight?a.targetCharNode.style.borderRightColor=a.nextColor:a.targetCharNode.style.borderLeftColor=a.nextColor;var b=a.targetCharNode;curtop=0;if(b.offsetParent)for(curtop=b.offsetTop;b=b.offsetParent;)curtop+=b.offsetTop;a.hijacker.style.top=""+curtop+"px"}clearTimeout(a.cycleTimeout);a.cycleTimeout=setTimeout(a.cycle,c?960:480)},target:function(c,b){a.targetCharNode!==c?(a.relieve(a.targetCharNode),
a.untarget(a.targetCharNode)):void 0===b&&(b=!a.targetCharNode.forceRight,a.relieve(a.targetCharNode));a.targetCharNode=c;a.targetCharNode.style.backgroundColor=a.targetCharNode.style.backgroundColor||"transparent";b?(a.targetCharNode.style.borderRightWidth="2px",a.targetCharNode.style.borderRightStyle="solid",a.targetCharNode.style.borderRightColor="black",a.targetCharNode.style.marginRight="-2px",a.targetCharNode.forceRight=!0):(a.targetCharNode.style.borderLeftWidth="2px",a.targetCharNode.style.borderLeftStyle=
"solid",a.targetCharNode.style.borderLeftColor="black",a.targetCharNode.style.marginLeft="-2px",a.targetCharNode.forceRight=!1);a.cycle(!0);a.preventUntarget=!0;a.hijacker.click();a.hijacker.focus();a.preventUntarget=!0},untarget:function(){a.preventUntarget?a.preventUntarget=!1:a.targetCharNode&&a.targetCharNode.style&&(a.relieve(a.targetCharNode),a.targetCharNode=null)},relieve:function(a){a&&(a.forceRight=!1,a.style&&(a.style.borderRightWidth="",a.style.borderRightStyle="",a.style.borderRightColor=
"",a.style.marginRight="",a.style.borderLefttWidth="",a.style.borderLeftStyle="",a.style.borderLeftColor="",a.style.marginLeft=""))},isReady:function(){return a.targetCharNode},putNode:function(c){a.targetCharNode.forceRight?(a.targetCharNode.parentNode.insertBefore(c,a.targetCharNode.nextSibling),c.nextSibling&&c.nextSibling.goofyTextChr?a.target(c.nextSibling):a.target(c,!0)):(a.targetCharNode.parentNode.insertBefore(c,a.targetCharNode),a.cycle(!0));return a},putChar:function(c){a.putNode(i(c))},
putText:function(c){for(var b=!!window.attachEvent,d=!1,e=0;e<c.length;++e)1<e&&b&&d&&"\n"===c.charAt(e)?(console.log("Continuing"),d=!1):(d=!0,a.putChar(c.charAt(e)))},keydown:function(c){if(a.isReady())switch(c=c||window.event,String.fromCharCode(c.keyCode),c.keyCode){case 8:if(a.targetCharNode.forceRight){var b=a.targetCharNode;a.target(a.targetCharNode.nextSibling||a.targetCharNode.previousSibling,!a.targetCharNode.nextSibling);b.parentNode.removeChild(b)}else a.targetCharNode.previousSibling&&
a.targetCharNode.parentNode.removeChild(a.targetCharNode.previousSibling);c.keyCode=0;c.preventDefault&&c.preventDefault();break;case 9:a.untarget();break;case 13:return console.log("Enter"),a.putChar("\n"),c.keyCode=0,c.preventDefault&&c.preventDefault(),!1;case 35:for(b=a.targetCharNode;b.parentNode&&b.nextSibling&&b.nextSibling.parentNode&&b.parentNode===b.nextSibling.parentNode&&b.offsetTop===b.nextSibling.offsetTop;)b=b.nextSibling;a.target(b,!b.isNewLine);c.keyCode=0;c.preventDefault&&c.preventDefault();
return!1;case 36:for(b=a.targetCharNode;b.parentNode&&b.previousSibling&&b.previousSibling.parentNode&&b.parentNode===b.previousSibling.parentNode&&b.offsetTop===b.previousSibling.offsetTop;)b=b.previousSibling;a.target(b,!1);c.keyCode=0;c.preventDefault&&c.preventDefault();return!1;case 37:for(b=a.targetCharNode;null!==b;){if(b.forceRight){a.target(b,!1);break}if((b=b.previousSibling)&&b.goofyTextChr){a.target(b,!b.nextSibling.goofyTextChr);break}}c.keyCode=0;c.preventDefault&&c.preventDefault();
return!1;case 39:for(b=a.targetCharNode;null!==b;)if((b=b.nextSibling)&&b.goofyTextChr){a.target(b,b===a.targetCharNode);break}else a.targetCharNode.forceRight||(b=null);b||a.target(a.targetCharNode,!0);c.keyCode=0;c.preventDefault&&c.preventDefault();return!1;case 46:a.targetCharNode.forceRight?a.targetCharNode.nextSibling&&a.targetCharNode.parentNode.removeChild(a.targetCharNode.nextSibling):(b=a.targetCharNode,a.target(a.targetCharNode.nextSibling||a.targetCharNode.previousSibling),a.targetCharNode.parentNode.removeChild(b))}}};
window.goofyText={};window.goofyText.editor=function(){if(arguments.length)for(var a=0;a<arguments.length;++a)k(arguments[a]),j(arguments[a],void 0);else return a=document.createElement("DIV"),k(a),a};d.call(a.hijacker,"keydown",a.keydown);d.call(document,"click",function(){a.untarget()});void 0!==a.hijacker.oninput?d.call(a.hijacker,"input",function(){a.processHijacker()}):d.call(a.hijacker,"keydown",function(){setTimeout(a.processHijacker,5)});a.hijacker.style.position="absolute";a.hijacker.style.left=
"0px";a.hijacker.style.top="0px";a.hijacker.style.width="10px";a.hijacker.style.height="10px";a.hijacker.style.padding="0px";a.hijacker.style.border="0px";a.hijacker.style.margin="0px";a.hijacker.style.overflow="hidden";a.hijacker.style.backgroundColor="red";document.body.appendChild(a.hijacker);goofyTextDebug={cursor:a};h=a.hijacker})();